<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.bjpowernode.crm.workbench.dao.CustomerDao">
    <insert id="save">
        insert into tbl_customer(
		id,
        owner,
        name,
        website,
        phone,
        createBy,
        createTime,
        contactSummary,
        nextContactTime,
        description,
        banquetDate,
        banquetVenue,
        nature,
        childrenName,
        nPeopleName,
        nPeoplePhone,
        childrenAddress,
        childrenPhone
)values(
        #{id},
        #{owner},
        #{name},
        #{website},
        #{phone},
        #{createBy},
        #{createTime},
        #{contactSummary},
        #{nextContactTime},
        #{description},
        #{banquetDate},
        #{banquetVenue},
        #{nature},
        #{childrenName},
        #{nPeopleName},
        #{nPeoplePhone},
        #{childrenAddress},
        #{childrenPhone}
        )
    </insert>
    <select id="getCustomerListByCondition" resultType="customer">
        select
        cus.id,
        cus.name,
        u.name as owner,
        cus.phone,
        cus.banquetDate,
        cus.banquetVenue
        from tbl_customer cus join
    tbl_user u on cus.owner=u.id
        <where>
            <if test="name!=null and name!=''">
                cus.name like '%' #{name} '%'
            </if>
            <if test="owner!=null and owner!=''">
                and u.name like '%' #{owner} '%'
            </if>
            <if test="phone!=null and phone!=''">
                and cus.phone=#{phone}
            </if>
            <if test="startDate!=null and startDate!=''">
                and cus.banquetDate &gt; #{startDate}
            </if>
            <if test="endDate!=null and endDate!=''">
                and cus.banquetDate &lt; #{endDate}
            </if>
        </where>
        order by cus.createTime desc
        limit #{skipCount},#{pageSize}
    </select>
<select id="getTotalByCondition" resultType="int">
    select count(*) from tbl_customer cus join
    tbl_user u on cus.owner=u.id
    <where>
        <if test="name!=null and name!=''">
            cus.name like '%' #{name} '%'
        </if>
        <if test="owner!=null and owner!=''">
            and u.name like '%' #{owner} '%'
        </if>
        <if test="phone!=null and phone!=''">
            and cus.phone=#{phone}
        </if>
        <if test="startDate!=null and startDate!=''">
            and cus.banquetDate &gt; #{startDate}
        </if>
        <if test="endDate!=null and endDate!=''">
            and cus.banquetDate &lt; #{endDate}
        </if>
    </where>
</select>
    <select id="getCustomerByPhone" resultType="int">
        select count(*) from tbl_customer where phone=#{phone}
    </select>
    <select id="getCustomerName" resultType="string">
        select name from tbl_customer where name like '%' #{name} '%'
    </select>
	<select id="getCustomerByName" resultType="customer">
        select * from tbl_customer where name=#{name}
    </select>
<!-- <insert id="save" >
        insert into tbl_customer(
        id
     owner,
        name,
        website,
        phone,
        createBy,
        createTime,
        contactSummary,
        nextContactTime,
        description,
        address
        )values(
        #{id}
        #{owner},
        #{name},
        #{website},
        #{phone},
        #{createBy},
        #{createTime},
        #{contactSummary},
        #{nextContactTime},
        #{description},
        #{address}
        )
    </insert>-->
</mapper>

































